<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-博客园美化" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/13/博客园美化/" class="article-date">
  <time datetime="2018-01-13T11:17:20.000Z" itemprop="datePublished">2018-01-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/13/博客园美化/">博客园美化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/13/博客园美化/" data-id="cjjwkdfox0010hsuqcnm3gnby" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-UML类图的基本关系" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/08/UML类图的基本关系/" class="article-date">
  <time datetime="2018-01-08T05:42:53.000Z" itemprop="datePublished">2018-01-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/08/UML类图的基本关系/">UML类图的基本关系</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> 在UML类图中，常见的有以下几种关系: 泛化（Generalization）,  实现（Realization），关联（Association)，聚合（Aggregation），组合(Composition)，依赖(Dependency)</p>
<h2 id="泛化（Generalization）"><a href="#泛化（Generalization）" class="headerlink" title="泛化（Generalization）"></a>泛化（Generalization）</h2><p>【泛化关系】：是一种继承关系，表示一般与特殊的关系，它指定了子类如何特化父类的所有特征和行为。例如：老虎是动物的一种，即有老虎的特性也有动物的共性。<br>【箭头指向】：带三角箭头的实线，箭头指向父类<br><img src="/2018/01/08/UML类图的基本关系/Generalization.gif" alt="Generalization"></p>
<h2 id="实现（Realization）"><a href="#实现（Realization）" class="headerlink" title="实现（Realization）"></a>实现（Realization）</h2><p>【实现关系】：是一种类与接口的关系，表示类是接口所有特征和行为的实现.<br>【箭头指向】：带三角箭头的虚线，箭头指向接口<br><img src="/2018/01/08/UML类图的基本关系/Realization.gif" alt="Realization"></p>
<h2 id="关联（Association"><a href="#关联（Association" class="headerlink" title="关联（Association)"></a>关联（Association)</h2><p>【关联关系】：是一种拥有的关系，它使一个类知道另一个类的属性和方法；如：老师与学生，丈夫与妻子关联可以是双向的，也可以是单向的。双向的关联可以有两个箭头或者没有箭头，单向的关联有一个箭头。<br>【代码体现】：成员变量<br>【箭头及指向】：带普通箭头的实心线，指向被拥有者<br><img src="/2018/01/08/UML类图的基本关系/Association.gif" alt="Association"></p>
<p>上图中，老师与学生是双向关联，老师有多名学生，学生也可能有多名老师。但学生与某课程间的关系为单向关联，一名学生可能要上多门课程，课程是个抽象的东西他不拥有学生。<br>下图为自身关联：<br><img src="/2018/01/08/UML类图的基本关系/AssociationSelf.gif" alt="AssociationSelf"></p>
<h2 id="聚合（Aggregation）"><a href="#聚合（Aggregation）" class="headerlink" title="聚合（Aggregation）"></a>聚合（Aggregation）</h2><p>【聚合关系】：是整体与部分的关系，且部分可以离开整体而单独存在。如车和轮胎是整体和部分的关系，轮胎离开车仍然可以存在。<br>聚合关系是关联关系的一种，是强的关联关系；关联和聚合在语法上无法区分，必须考察具体的逻辑关系。<br>【代码体现】：成员变量<br>【箭头及指向】：带空心菱形的实心线，菱形指向整体<br><img src="/2018/01/08/UML类图的基本关系/Aggregation.gif" alt="Aggregation"></p>
<h2 id="组合-Composition"><a href="#组合-Composition" class="headerlink" title="组合(Composition)"></a>组合(Composition)</h2><p>【组合关系】：是整体与部分的关系，但部分不能离开整体而单独存在。如公司和部门是整体和部分的关系，没有公司就不存在部门。<br>   组合关系是关联关系的一种，是比聚合关系还要强的关系，它要求普通的聚合关系中代表整体的对象负责代表部分的对象的生命周期。<br>【代码体现】：成员变量<br>【箭头及指向】：带实心菱形的实线，菱形指向整体<br><img src="/2018/01/08/UML类图的基本关系/Composition.gif" alt="Composition"></p>
<h2 id="依赖-Dependency"><a href="#依赖-Dependency" class="headerlink" title="依赖(Dependency)"></a>依赖(Dependency)</h2><p>【依赖关系】：是一种使用的关系，即一个类的实现需要另一个类的协助，所以要尽量不使用双向的互相依赖.<br>【代码表现】：局部变量、方法的参数或者对静态方法的调用<br>【箭头及指向】：带箭头的虚线，指向被使用者<br><img src="/2018/01/08/UML类图的基本关系/Dependency.gif" alt="Dependency"></p>
<h2 id="各种关系的强弱顺序："><a href="#各种关系的强弱顺序：" class="headerlink" title="各种关系的强弱顺序："></a>各种关系的强弱顺序：</h2><p>泛化 = 实现 &gt; 组合 &gt; 聚合 &gt; 关联 &gt; 依赖<br>下面这张UML图，比较形象地展示了各种类图关系：<br><img src="/2018/01/08/UML类图的基本关系/All.png" alt="All"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/08/UML类图的基本关系/" data-id="cjjwkdfot000yhsuqun6q9icc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/07/JavaScript/" class="article-date">
  <time datetime="2018-01-07T09:19:55.000Z" itemprop="datePublished">2018-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/07/JavaScript/">JavaScript</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文：<a href="http://www.cnblogs.com/wangfupeng1988/p/3994950.html" target="_blank" rel="noopener">http://www.cnblogs.com/wangfupeng1988/p/3994950.html</a></p>
<h1 id="JavaScript判断对象是值类型还是引用类型的方法"><a href="#JavaScript判断对象是值类型还是引用类型的方法" class="headerlink" title="JavaScript判断对象是值类型还是引用类型的方法"></a>JavaScript判断对象是值类型还是引用类型的方法</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var fn = function () &#123; &#125;;</span><br><span class="line">console.log(fn instanceof Object);  // true</span><br></pre></td></tr></table></figure>
<h1 id="对象-若干属性和集合"><a href="#对象-若干属性和集合" class="headerlink" title="对象-若干属性和集合"></a>对象-若干属性和集合</h1><ul>
<li>JavaScript的一切皆是对象</li>
<li>对象里面一切皆是属性，没有方法，方法是一种表现为键值对的属性。</li>
</ul>
<h1 id="对象都是通过函数来创建的"><a href="#对象都是通过函数来创建的" class="headerlink" title="对象都是通过函数来创建的"></a>对象都是通过函数来创建的</h1><h1 id="javascript中的this"><a href="#javascript中的this" class="headerlink" title="javascript中的this"></a>javascript中的this</h1><p>在函数中this到底如何取值，是在函数真正被调用执行时确定的，函数定义的时候确定不了。<br>this的取值，分四种情况：</p>
<ul>
<li>构造函数</li>
<li>函数作为对象的一个属性</li>
<li>函数用call或者apply调用</li>
<li>全局&amp;调用普通函数<h2 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h2>如果函数作为构造函数用，this指向它即将new出来的对象。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function Foo()&#123;</span><br><span class="line">    this.name = &quot;aaaa&quot;;</span><br><span class="line">    this.year = &quot;2018&quot;;</span><br><span class="line">    console.log(this);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var f1 = new Foo();</span><br><span class="line">console.log(f1.name);</span><br><span class="line">console.log(f1.year);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>结果：<br><img src="/2018/01/07/JavaScript/构造函数.png" alt="constructor"><br>但是如果不是作为构造函数，也就是不是new Foo(),而是直接调用Foo(),则this指向的是Window<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function Foo()&#123;</span><br><span class="line">    this.name = &quot;aaaa&quot;;</span><br><span class="line">    this.year = &quot;2018&quot;;</span><br><span class="line">    console.log(this);</span><br><span class="line">&#125;</span><br><span class="line">Foo();</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/01/07/JavaScript/call direct.png" alt="call direct"></p>
<h2 id="函数作为对象的一个属性"><a href="#函数作为对象的一个属性" class="headerlink" title="函数作为对象的一个属性"></a>函数作为对象的一个属性</h2><p>如果函数作为对象的一个属性，并且作为一个对象的属性被调用时，函数的this指向该对象。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line">    x:10,</span><br><span class="line">    fn:function()&#123;</span><br><span class="line">        console.log(this);</span><br><span class="line">        console.log(this.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.fn();</span><br></pre></td></tr></table></figure></p>
<p>如果不是作为obj的属性被调用，则this指向Window<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line">    x:10,</span><br><span class="line">    fn:function()&#123;</span><br><span class="line">        console.log(this);</span><br><span class="line">        console.log(this.x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">var fn1 = obj.fn;</span><br><span class="line">fn1();</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/01/07/JavaScript/not call for property.png" alt="not call for property"></p>
<h2 id="函数用call或者apply调用"><a href="#函数用call或者apply调用" class="headerlink" title="函数用call或者apply调用"></a>函数用call或者apply调用</h2><p>当一个函数被call或apply调用时，this的值就取传入对象的值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123;</span><br><span class="line">    x:10</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var fn = function()&#123;</span><br><span class="line">    console.log(this);</span><br><span class="line">    console.log(this.x);</span><br><span class="line">&#125;</span><br><span class="line">fn.call(obj);</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/01/07/JavaScript/call or apply.png" alt="call or apply"></p>
<h2 id="全局-amp-调用普通函数"><a href="#全局-amp-调用普通函数" class="headerlink" title="全局&amp;调用普通函数"></a>全局&amp;调用普通函数</h2><p>在全局下，this永远是Window<br>普通函数在调用时，其中this就是Window，如上面1与2的第2个例子全是普通函数</p>
<h1 id="执行上下文"><a href="#执行上下文" class="headerlink" title="执行上下文"></a>执行上下文</h1><p>执行全局代码时，会产生一个执行上下文环境，函数每次调用都会产生一个函数上下文环境，当函数调用完成后，这个上下文环境以及其中的数据就会被消除，重新回到全局上下文环境。处于活动状态的上下文环境只有一个。<br>这都通过一个上下文栈来完成<br><img src="/2018/01/07/JavaScript/context stack.png" alt="context stack"></p>
<h1 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h1><ul>
<li>Javascript没有块级作用域，所谓的块就是{}中间的语句。</li>
<li>Javascript除了全局作用域外，只有函数可以创建的作用域。<br>所以在声明变量时，全局代码要在代码前端声明，函数中要在函数体一开始就声明好。除了这两个地方，其它地方不要出现变量声明，而且建议用”单var”形式。</li>
</ul>
<p><img src="/2018/01/07/JavaScript/作用域.png" alt="作用域"><br>作用域的最大作用就是隔离变量，不同作用域下同名变量不会有冲突。<br>作用域在函数定义时就已经确定了，而不是在函数调用时确定。</p>
<h1 id="自由变量"><a href="#自由变量" class="headerlink" title="自由变量"></a>自由变量</h1><p>自由变量要到创建这个函数那个作用域中取值。</p>
<h1 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h1><h2 id="函数作为返回值"><a href="#函数作为返回值" class="headerlink" title="函数作为返回值"></a>函数作为返回值</h2><p><img src="/2018/01/07/JavaScript/函数作为返回值.png" alt="函数作为返回值"><br>如上代码，bar函数作为返回值，赋值给f1变量。执行f1(15)时，用到了fn作用域下的max变量的值</p>
<h2 id="函数作为参数被传递"><a href="#函数作为参数被传递" class="headerlink" title="函数作为参数被传递"></a>函数作为参数被传递</h2><p><img src="/2018/01/07/JavaScript/函数作为参数被传递.png" alt="函数作为参数被传递"><br>如上代码中，fn函数作为一个参数被传递进入另一个函数，赋值给f参数。执行f(15)时，max变量的取值是10，而不是100。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/07/JavaScript/" data-id="cjjwkdfmy000ghsuq0xd2adwe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/学习笔记/">学习笔记</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-日常代码积累" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/07/日常代码积累/" class="article-date">
  <time datetime="2018-01-07T09:05:56.000Z" itemprop="datePublished">2018-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/07/日常代码积累/">日常代码积累</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-字符的全半角转换"><a href="#1-字符的全半角转换" class="headerlink" title="1. 字符的全半角转换"></a>1. 字符的全半角转换</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">/// &lt;summary&gt;</span><br><span class="line">      /// 转全角(SBC case)</span><br><span class="line">      /// &lt;/summary&gt;</span><br><span class="line">      /// &lt;param name=&quot;input&quot;&gt;任意字符串&lt;/param&gt;</span><br><span class="line">      /// &lt;returns&gt;全角字符串&lt;/returns&gt;</span><br><span class="line">      public static string ToSBC(this string input)</span><br><span class="line">      &#123;</span><br><span class="line">          char[] c = input.ToCharArray();</span><br><span class="line">          for (int i = 0; i &lt; c.Length; i++)</span><br><span class="line">          &#123;</span><br><span class="line">              if (c[i] == 32)</span><br><span class="line">              &#123;</span><br><span class="line">                  c[i] = (char)12288;</span><br><span class="line">                  continue;</span><br><span class="line">              &#125;</span><br><span class="line">              if (c[i] &lt; 127)</span><br><span class="line">                  c[i] = (char)(c[i] + 65248);</span><br><span class="line">          &#125;</span><br><span class="line">          return new string(c);</span><br><span class="line">      &#125;</span><br><span class="line">      /// &lt;summary&gt;</span><br><span class="line">      /// 转半角(DBC case)</span><br><span class="line">      /// &lt;/summary&gt;</span><br><span class="line">      /// &lt;param name=&quot;input&quot;&gt;任意字符串&lt;/param&gt;</span><br><span class="line">      /// &lt;returns&gt;半角字符串&lt;/returns&gt;</span><br><span class="line">      public static string ToDBC(this string input)</span><br><span class="line">      &#123;</span><br><span class="line">          char[] c = input.ToCharArray();</span><br><span class="line">          for (int i = 0; i &lt; c.Length; i++)</span><br><span class="line">          &#123;</span><br><span class="line">              if (c[i] == 12288)</span><br><span class="line">              &#123;</span><br><span class="line">                  c[i] = (char)32;</span><br><span class="line">                  continue;</span><br><span class="line">              &#125;</span><br><span class="line">              if (c[i] &gt; 65280 &amp;&amp; c[i] &lt; 65375)</span><br><span class="line">                  c[i] = (char)(c[i] - 65248);</span><br><span class="line">          &#125;</span><br><span class="line">          return new string(c);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<h1 id="2-javascript-大小写转换"><a href="#2-javascript-大小写转换" class="headerlink" title="2. javascript 大小写转换"></a>2. javascript 大小写转换</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//转换成大写人民币</span></span><br><span class="line"><span class="keyword">var</span> digitUppercase = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fraction = [<span class="string">'角'</span>, <span class="string">'分'</span>];</span><br><span class="line">    <span class="keyword">var</span> digit = [</span><br><span class="line">        <span class="string">'零'</span>, <span class="string">'壹'</span>, <span class="string">'贰'</span>, <span class="string">'叁'</span>, <span class="string">'肆'</span>,</span><br><span class="line">        <span class="string">'伍'</span>, <span class="string">'陆'</span>, <span class="string">'柒'</span>, <span class="string">'捌'</span>, <span class="string">'玖'</span></span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">var</span> unit = [</span><br><span class="line">        [<span class="string">'元'</span>, <span class="string">'万'</span>, <span class="string">'亿'</span>],</span><br><span class="line">        [<span class="string">''</span>, <span class="string">'拾'</span>, <span class="string">'佰'</span>, <span class="string">'仟'</span>]</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">var</span> head = n &lt; <span class="number">0</span> ? <span class="string">'欠'</span> : <span class="string">''</span>;</span><br><span class="line">    n = <span class="built_in">Math</span>.abs(n);</span><br><span class="line">    <span class="keyword">var</span> s = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; fraction.length; i++) &#123;</span><br><span class="line">        s += (digit[<span class="built_in">Math</span>.floor(n * <span class="number">10</span> * <span class="built_in">Math</span>.pow(<span class="number">10</span>, i)) % <span class="number">10</span>] + fraction[i]).replace(<span class="regexp">/零./</span>, <span class="string">''</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    s = s || <span class="string">'整'</span>;</span><br><span class="line">    n = <span class="built_in">Math</span>.floor(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; unit[<span class="number">0</span>].length &amp;&amp; n &gt; <span class="number">0</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> p = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; unit[<span class="number">1</span>].length &amp;&amp; n &gt; <span class="number">0</span>; j++) &#123;</span><br><span class="line">            p = digit[n % <span class="number">10</span>] + unit[<span class="number">1</span>][j] + p;</span><br><span class="line">            n = <span class="built_in">Math</span>.floor(n / <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        s = p.replace(<span class="regexp">/(零.)*零$/</span>, <span class="string">''</span>).replace(<span class="regexp">/^$/</span>, <span class="string">'零'</span>) + unit[<span class="number">0</span>][i] + s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head + s.replace(<span class="regexp">/(零.)*零元/</span>, <span class="string">'元'</span>)</span><br><span class="line">        .replace(<span class="regexp">/(零.)+/g</span>, <span class="string">'零'</span>)</span><br><span class="line">        .replace(<span class="regexp">/^整$/</span>, <span class="string">'零元整'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3-获取两个List或数组的差集与交集"><a href="#3-获取两个List或数组的差集与交集" class="headerlink" title="3. 获取两个List或数组的差集与交集"></a>3. 获取两个List或数组的差集与交集</h1><h2 id="3-1-差集"><a href="#3-1-差集" class="headerlink" title="3.1. 差集"></a>3.1. 差集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">List&lt;int&gt; list1 = new List&lt;int&gt;();</span><br><span class="line">list1.Add(1);</span><br><span class="line">list1.Add(2);</span><br><span class="line">list1.Add(3);</span><br><span class="line">List&lt;int&gt; list2 = new List&lt;int&gt;();</span><br><span class="line">list2.Add(3);</span><br><span class="line">list2.Add(4);</span><br><span class="line">list2.Add(5);</span><br><span class="line">//得到的结果是4,5 即减去了相同的元素。</span><br><span class="line">List&lt;int&gt; list3 = list2.Except(list1).ToList();</span><br><span class="line">foreach (int i in list3)</span><br><span class="line">&#123;</span><br><span class="line">    MessageBox.Show(i.ToString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-2-合并两个数组-并去掉重复元素-然后排序-C"><a href="#3-2-合并两个数组-并去掉重复元素-然后排序-C" class="headerlink" title="3.2. 合并两个数组,并去掉重复元素,然后排序(C#)"></a>3.2. 合并两个数组,并去掉重复元素,然后排序(C#)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;int&gt; numbers1 = new List&lt;int&gt;() &#123; 5, 4, 1, 3, 9, 8, 6, 7, 12, 10 &#125;;</span><br><span class="line">List&lt;int&gt; numbers2 = new List&lt;int&gt;() &#123; 15, 14, 11, 13, 19, 18, 16, 17, 12, 10 &#125;;</span><br><span class="line">var newQuerty = numbers1.Concat(</span><br><span class="line">from n in numbers2</span><br><span class="line">where !numbers1.Contains(n)</span><br><span class="line">select n</span><br><span class="line">).OrderBy(n=&gt;n);</span><br></pre></td></tr></table></figure>
<h2 id="3-3-合并两个数组，并去除合并后的重复数据，-并排序"><a href="#3-3-合并两个数组，并去除合并后的重复数据，-并排序" class="headerlink" title="3.3. 合并两个数组，并去除合并后的重复数据， 并排序"></a>3.3. 合并两个数组，并去除合并后的重复数据， 并排序</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int[] A=&#123;1,2,2,3,4,5,6,6,6&#125;;</span><br><span class="line">int[] B=&#123;2,2,2,3,7,8,9,5&#125;;</span><br><span class="line">List&lt;int&gt; list = new List&lt;int&gt;(A);</span><br><span class="line">list.AddRange(B);</span><br></pre></td></tr></table></figure>
<h1 id="4-List-lt-父类-gt-引用List-lt-子类-gt"><a href="#4-List-lt-父类-gt-引用List-lt-子类-gt" class="headerlink" title="4. List&lt;父类&gt;引用List&lt;子类&gt;"></a>4. List&lt;父类&gt;引用List&lt;子类&gt;</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Father</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">public class Son:Father</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Test</span><br><span class="line">&#123;</span><br><span class="line">    public void Test()</span><br><span class="line">    &#123;</span><br><span class="line">        List&lt;Father&gt; fathers = new List&lt;Father&gt;();</span><br><span class="line">        List&lt;Son&gt; sons = new List&lt;Sons&gt;();</span><br><span class="line">        sons = sons.Cast&lt;Father&gt;().ToList();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="List-lt-T-gt-的一些概念"><a href="#List-lt-T-gt-的一些概念" class="headerlink" title="List&lt;T&gt; 的一些概念"></a>List&lt;T&gt; 的一些概念</h2><ul>
<li>List&lt;T&gt;初始值大小是4，自动扩容是以当前数组元素的两倍或InsertRange目标List的元素个数来扩容（如个大选如个）。如果比较确定的大小可以考虑提前设置，因为每次自动扩容需要重新分配数组和copy元素，性能损耗不小。</li>
<li>List&lt;T&gt;通过version来跟踪集合是否发生改变，如果在foreach遍历时发生改变则发生异常。</li>
<li>List&lt;T&gt;并非线程安全，任何使用的时候都要考虑当前环境是否可能有多线程存在，是否需要用锁来保证集合线程安全。</li>
</ul>
<h1 id="EasyUI-Dialog"><a href="#EasyUI-Dialog" class="headerlink" title="EasyUI Dialog"></a>EasyUI Dialog</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DlogOwner</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    $(<span class="string">"#dlg"</span>).dialog(&#123;</span><br><span class="line">        title: <span class="string">'人员信息'</span>,</span><br><span class="line">        modal: <span class="literal">true</span>,</span><br><span class="line">        closed: <span class="literal">true</span>,</span><br><span class="line">        href: url,</span><br><span class="line">        queryParams: &#123; <span class="attr">type</span>: <span class="string">'add'</span>, <span class="attr">income_id</span>: $(<span class="string">"#income_id3"</span>).val() &#125;,</span><br><span class="line">        buttons: [&#123;</span><br><span class="line">            text: <span class="string">'取消'</span>,</span><br><span class="line">            handler: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">'#dlg'</span>).dialog(<span class="string">'close'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;],</span><br><span class="line">        onClose: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> income_id = $(<span class="string">"#income_id3"</span>).val();</span><br><span class="line">            FillNewOwner(income_id);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//content: "&lt;iframe scrolling='auto' frameborder='0' src='" + url + "' style='width:100%; height:100%; display:block;'&gt;&lt;/iframe&gt;"</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getQueryParam</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> obj = $(<span class="string">'#dd'</span>).dialog(<span class="string">'options'</span>);</span><br><span class="line">            <span class="keyword">var</span> queryParams = obj[<span class="string">"queryParams"</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> queryParams[name];</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h1 id="5-隐藏下拉框"><a href="#5-隐藏下拉框" class="headerlink" title="5. 隐藏下拉框"></a>5. 隐藏下拉框</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">select</span> &#123;  </span><br><span class="line"><span class="comment">/*Chrome和Firefox里面的边框是不一样的，所以复写了一下*/</span>  </span><br><span class="line"><span class="attribute">border</span>: solid <span class="number">1px</span> <span class="number">#000</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/*很关键：将默认的select选择框样式清除*/</span>  </span><br><span class="line"><span class="attribute">appearance</span>:none;  </span><br><span class="line"><span class="attribute">-moz-appearance</span>:none;  </span><br><span class="line"><span class="attribute">-webkit-appearance</span>:none;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/*在选择框的最右侧中间显示小箭头图片*/</span>  </span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"http://ourjs.github.io/static/2015/arrow.png"</span>) no-repeat scroll right center transparent;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/*为下拉小箭头留出一点位置，避免被文字覆盖*/</span>  </span><br><span class="line"><span class="attribute">padding-right</span>: <span class="number">14px</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/*清除ie的默认选择框样式清除，隐藏下拉箭头*/</span>  </span><br><span class="line"><span class="selector-tag">select</span><span class="selector-pseudo">::-ms-expand</span> &#123; <span class="attribute">display</span>: none; &#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/07/日常代码积累/" data-id="cjjwkdfp10014hsuqkqb3nqb1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Visual-Studio-2017无法添加引用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/07/Visual-Studio-2017无法添加引用/" class="article-date">
  <time datetime="2018-01-07T07:43:02.000Z" itemprop="datePublished">2018-01-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/07/Visual-Studio-2017无法添加引用/">Visual Studio 2017无法添加引用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>本机装了Visual Studio2017与2012两个版本，不知道是不是有冲突还是其它的一些原因，在2017项目中添加引用时总是报错，错误信息如下图所示：<br><img src="/2018/01/07/Visual-Studio-2017无法添加引用/Error1.png" alt="Error Image"></p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><ol>
<li>用管理员权限打开命令行（不用管理员权限进行下面的操作可能会提示无权限）<br>在命行中打开如下路径:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\PublicAssemblies</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>此路径因安装visaul studio的位置不同而不同，我装在C盘</p>
<ol start="2">
<li>添加环境变量<br>在path下添加<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\x64</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/2018/01/07/Visual-Studio-2017无法添加引用/EditPath.png" alt="EditPath"></p>
<ol start="3">
<li>执行如下命令<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gacutil -i Microsoft.VisualStudio.Shell.Interop.11.0.dll</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="/2018/01/07/Visual-Studio-2017无法添加引用/Add Succeed.png" alt="Add Succeed"><br>完成后重启Visual Studio，查看问题是否解决</p>
<h2 id="resharper"><a href="#resharper" class="headerlink" title="resharper"></a>resharper</h2><p>在线服务器<br><a href="http://idea.iteblog.com/key.php" target="_blank" rel="noopener">http://idea.iteblog.com/key.php</a><br><a href="http://xidea.online" target="_blank" rel="noopener">http://xidea.online</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/07/Visual-Studio-2017无法添加引用/" data-id="cjjwkdfok000uhsuq21l8gmzw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Log4net学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/06/Log4net学习/" class="article-date">
  <time datetime="2018-01-06T10:12:28.000Z" itemprop="datePublished">2018-01-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/06/Log4net学习/">Log4net学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Log4net的结构"><a href="#Log4net的结构" class="headerlink" title="Log4net的结构"></a>Log4net的结构</h1><p>Log4net有四种主要组件，分别是：</p>
<ul>
<li>Logger：记录器</li>
<li>Repository：库</li>
<li>Appender：附着器</li>
<li>Layout：布局<h2 id="Logger"><a href="#Logger" class="headerlink" title="Logger"></a>Logger</h2>Logger是应用程序需要交互的主要组件，它用来产生日志消息。产生的日志消息并不直接显示，还要预先经过Layout的格式化处理后才会输出。<br>Logger提供了多种方式来记录一个日志消息，你可以在你的应用程序里创建多个Logger，每个实例化的Logger对象都被log4net框架作为命名实体(named entity)来维护。这意味着为了重用Logger对象，你不必将它在不同的类或对象间传递，只需要用它的名字为参数调用就可以了。log4net框架使用继承体系，继承体系类似于.NET中的名字空间。也就是说，如果有两个logger,分别被定义为a.b.c和a.b，那么我们说a.b是a.b.c的祖先。每一个logger都继承了祖先的属性。<br>Log4net框架定义了一个ILog接口，所有的logger类都必须实现这个接口。<br>Log4net框架定义了一个叫做LogManager的类，用来管理所有的logger对象。它有一个GetLogger()静态方法，用我们提供的名字参数来检索已经存在的Logger对象。如果框架里不存在该Logger对象，它也会为我们创建一个Logger对象。代码如下所示：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4net.ILog log = log4net.LogManager.GetLogger(&quot;logger-name&quot;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>通常来说，我们会以类（class）的类型（type）为参数来调用GetLogger()，以便跟踪我们正在进行日志记录的类。传递的类(class)的类型(type)可以用typeof(Classname)方法来获得，或者可以用如下的反射方法来获得：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.Reflection.MethodBase.GetCurrentMethod().DeclaringType</span><br></pre></td></tr></table></figure></p>
<p>尽管符号长了一些，但是后者可以用于一些场合，比如获取调用方法的类(class)的类型(type)。</p>
<h2 id="日志的级别"><a href="#日志的级别" class="headerlink" title="日志的级别"></a>日志的级别</h2><p>日志的级别作为常量定义在log4net.spi.Level类中。<br>级别由低到高<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">All Debug Info Warn Error Fatal Off</span><br></pre></td></tr></table></figure></p>
<p>在log4net框架里，通过设置配置文件，每个日志对象都被分配了一个日志优先级别。如果没有给一个日志对象显式地分配一个级别，那么该对象会试图从他的祖先继承一个级别值。<br>举例说明，当你创建了一个日志对象，并且把他的级别设置为INFO。于是框架会设置日志的每个Boolean属性。当你调用相应的日志方法时，框架会检查相应的Boolean属性，以决定该方法能不能执行。如下的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Logger.Info(&quot;message&quot;);</span><br><span class="line">Logger.Debug(&quot;message&quot;);</span><br><span class="line">Logger.Warn(&quot;message&quot;);</span><br></pre></td></tr></table></figure></p>
<p>对于第一种方法，Info()的级别等与日志的级别（INFO），因此日志请求会被传递，我们可以得到输出结果”message”。<br>对于第二种方法，Debug()的级别低于日志对象logger的日志级别(INFO)，因此，日志请求被拒绝了，我们得不到任何输出。同样的，针对第三行语句，我们可以很容易得出结论。<br>你也可以显式地检查Logger对象的Boolean属性，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (logger.IsDebugEnabled)</span><br><span class="line">&#123;</span><br><span class="line">  Logger.Debug(&quot;message&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h2><p>Repository主要用于负责日志对象组织结构的维护。在log4net的以前版本中，框架仅支持分等级的组织结构(hierarchical organization)。这种等级结构本质上是库的一个实现，并且定义在log4net.Repository.Hierarchy 名字空间中。要实现一个Repository，需要实现log4net.Repository.ILoggerRepository 接口。但是通常并不是直接实现该接口，而是以log4net.Repository.LoggerRepositorySkeleton为基类继承。体系库 (hierarchical repository )则由log4net.Repository.Hierarchy.Hierarchy类实现。<br>如果你是个log4net框架的使用者，而非扩展者，那么你几乎不会在你的代码里用到Repository的类。相反的，你需要用到LogManager类来自动管理库和日志对象</p>
<h2 id="Appender"><a href="#Appender" class="headerlink" title="Appender"></a>Appender</h2><p>一个好的日志框架应该能够产生多目的地的输出。比如说输出到控制台或保存到一个日志文件。log4net 能够很好的满足这些要求。它使用一个叫做Appender的组件来定义输出介质。正如名字所示，这些组件把它们附加到Logger日志组件上并将输出传递到输出流中。你可以把多个Appender组件附加到一个日志对象上。 Log4net框架提供了几个Appender组件。关于log4net提供的Appender组件的完整列表可以在log4net框架的帮助手册中找到。有了这些现成的Appender组件，一般来说你没有必要再自己编写了。但是如果你愿意，可以从log4net.Appender.AppenderSkeleton类继承。</p>
<h2 id="Appender-Filters"><a href="#Appender-Filters" class="headerlink" title="Appender Filters"></a>Appender Filters</h2><p>一个Appender 对象缺省地将所有的日志事件传递到输出流。Appender的过滤器(Appender Filters) 可以按照不同的标准过滤日志事件。在log4net.Filter的名字空间下已经有几个预定义的过滤器。使用这些过滤器，你可以按照日志级别范围过滤日志事件，或者按照某个特殊的字符串进行过滤。你可以在API的帮助文件中发现更多关于过滤器的信息。</p>
<h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><p>Layout 组件用于向用户显示最后经过格式化的输出信息。输出信息可以以多种格式显示，主要依赖于我们采用的Layout组件类型。可以是线性的或一个XML文件。Layout组件和一个Appender组件一起工作。API帮助手册中有关于不同Layout组件的列表。一个Appender对象，只能对应一个Layout对象。要实现你自己的Layout类，你需要从log4net.Layout.LayoutSkeleton类继承，它实现了ILayout接口。</p>
<h1 id="在程序中使用"><a href="#在程序中使用" class="headerlink" title="在程序中使用"></a>在程序中使用</h1><p>在开始对你的程序进行日志记录前，需要先启动log4net引擎。这意味着你需要先配置前面提到的三种组件。你可以用两种方法来设定配置：在单独的文件中设定配置或在代码中定义配置。<br>因为下面几种原因，推荐在一个单独的文件中定义配置：</p>
<ul>
<li>你不需要重新编译源代码就能改变配置；</li>
<li>你可以在程序正运行的时候就改变配置。这一点在一些WEB程序和远程过程调用的程序中有时很重要；<br>考虑到第一种方法的重要性，我们先看看怎样在文件中设定配置信息。</li>
</ul>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>配置信息可以放在如下几种形式文件的一种中。<br>在程序的配置文件里，如AssemblyName.config 或web.config.<br>在你自己的文件里。文件名可以是任何你想要的名字，如AppName.exe.xyz等.<br>log4net框架会在相对于AppDomain.CurrentDomain.BaseDirectory 属性定义的目录路径下查找配置文件。框架在配置文件里要查找的唯一标识是<log4net>标签。一个完整的配置文件的例子如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;configSections&gt;</span><br><span class="line">    &lt;section name=&quot;log4net&quot;</span><br><span class="line">      type=&quot;log4net.Config.Log4NetConfigurationSectionHandler,  log4net-net-1.0&quot;/&gt;</span><br><span class="line">  &lt;/configSections&gt;</span><br><span class="line">  &lt;log4net&gt;</span><br><span class="line">    &lt;root&gt;</span><br><span class="line">      &lt;level value=&quot;WARN&quot; /&gt;</span><br><span class="line">      &lt;appender-ref ref=&quot;LogFileAppender&quot; /&gt;</span><br><span class="line">      &lt;appender-ref ref=&quot;ConsoleAppender&quot; /&gt;</span><br><span class="line">    &lt;/root&gt;</span><br><span class="line">    &lt;logger name=&quot;testApp.Logging&quot;&gt;</span><br><span class="line">      &lt;level value=&quot;DEBUG&quot;/&gt;</span><br><span class="line">    &lt;/logger&gt;</span><br><span class="line">    &lt;appender name=&quot;LogFileAppender&quot;</span><br><span class="line">             type=&quot;log4net.Appender.FileAppender&quot; &gt;</span><br><span class="line">      &lt;param name=&quot;File&quot; value=&quot;log-file.txt&quot; /&gt;</span><br><span class="line">      &lt;param name=&quot;AppendToFile&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">      &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</span><br><span class="line">        &lt;param name=&quot;Header&quot; value=&quot;[Header]\r\n&quot;/&gt;</span><br><span class="line">        &lt;param name=&quot;Footer&quot; value=&quot;[Footer]\r\n&quot;/&gt;</span><br><span class="line">        &lt;param name=&quot;ConversionPattern&quot;</span><br><span class="line">           value=&quot;%d [%t] %-5p %c [%x]  - %m%n&quot;</span><br><span class="line">         /&gt;</span><br><span class="line">      &lt;/layout&gt;</span><br><span class="line">      &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</span><br><span class="line">        &lt;param name=&quot;LevelMin&quot; value=&quot;DEBUG&quot; /&gt;</span><br><span class="line">        &lt;param name=&quot;LevelMax&quot; value=&quot;WARN&quot; /&gt;</span><br><span class="line">      &lt;/filter&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">    &lt;appender name=&quot;ConsoleAppender&quot;</span><br><span class="line">              type=&quot;log4net.Appender.ConsoleAppender&quot; &gt;</span><br><span class="line">      &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</span><br><span class="line">        &lt;param name=&quot;ConversionPattern&quot;</span><br><span class="line">           value=&quot;%d [%t] %-5p %c [%x] - %m%n&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/layout&gt;</span><br><span class="line">    &lt;/appender&gt;</span><br><span class="line">  &lt;/log4net&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></log4net></p>
<p>你可以直接将上面的文本拷贝到任何程序中使用，但是最好还是能够理解配置文件是怎样构成的。 只有当你需要在应用程序配置文件中使用log4net配置时，才需要在<configsection>标签中加入<section>配置节点入口。对于其他的单独文件，只有<log4net>标签内的文本才是必需的，这些标签的顺序并不是固定的。下面我们依次讲解各个标签内文本的含义：</log4net></section></configsection></p>
<h3 id=""><a href="#" class="headerlink" title=""></a><root></root></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;root&gt;</span><br><span class="line">  &lt;level value=&quot;WARN&quot; /&gt;</span><br><span class="line">  &lt;appender-ref ref=&quot;LogFileAppender&quot; /&gt;</span><br><span class="line">  &lt;appender-ref ref=&quot;ConsoleAppender&quot; /&gt;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure>
<p>在框架的体系里，所有的日志对象都是根日志(root logger)的后代。 因此如果一个日志对象没有在配置文件里显式定义，则框架使用根日志中定义的属性。在<root>标签里，可以定义level级别值和Appender的列表。如果没有定义LEVEL的值，则缺省为DEBUG。可以通过<appender-ref>标签定义日志对象使用的Appender对象。<appender-ref>声明了在其他地方定义的Appender对象的一个引用。在一个logger对象中的设置会覆盖根日志的设置。而对Appender属性来说，子日志对象则会继承父日志对象的Appender列表。这种缺省的行为方式也可以通过显式地设定<logger>标签的additivity属性为false而改变。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;logger name=&quot;testApp.Logging&quot; additivity=&quot;false&quot;&gt;</span><br><span class="line">&lt;/logger&gt;</span><br></pre></td></tr></table></figure></logger></appender-ref></appender-ref></root></p>
<p>Additivity的值缺省是true.</p>
<h3 id="-1"><a href="#-1" class="headerlink" title=""></a><logger></logger></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;logger name=&quot;testApp.Logging&quot;&gt;</span><br><span class="line">  &lt;level value=&quot;DEBUG&quot;/&gt;</span><br><span class="line">&lt;/logger&gt;</span><br></pre></td></tr></table></figure>
<p><logger> 元素预定义了一个具体日志对象的设置。然后通过调用LogManager.GetLogger(“testAPP.Logging”)函数，你可以检索具有该名字的日志。如果LogManager.GetLogger(…)打开的不是预定义的日志对象，则该日志对象会继承根日志对象的属性。知道了这一点，我们可以说，其实<logger>标签并不是必须的。</logger></logger></p>
<h3 id="-2"><a href="#-2" class="headerlink" title=""></a><appender></appender></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;appender name=&quot;LogFileAppender&quot;</span><br><span class="line">          type=&quot;log4net.Appender.FileAppender&quot; &gt;</span><br><span class="line">  &lt;param name=&quot;File&quot; value=&quot;log-file.txt&quot; /&gt;</span><br><span class="line">  &lt;param name=&quot;AppendToFile&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">  &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;</span><br><span class="line">    &lt;param name=&quot;Header&quot; value=&quot;[Header]\r\n&quot; /&gt;</span><br><span class="line">    &lt;param name=&quot;Footer&quot; value=&quot;[Footer]\r\n&quot;/&gt;</span><br><span class="line">    &lt;param name=&quot;ConversionPattern&quot;</span><br><span class="line">      value=&quot;%d [%t] %-5p %c - %m%n&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/layout&gt;</span><br><span class="line">  &lt;filter type=&quot;log4net.Filter.LevelRangeFilter&quot;&gt;</span><br><span class="line">    &lt;param name=&quot;LevelMin&quot; value=&quot;DEBUG&quot; /&gt;</span><br><span class="line">    &lt;param name=&quot;LevelMax&quot; value=&quot;WARN&quot; /&gt;</span><br><span class="line">  &lt;/filter&gt;</span><br><span class="line">&lt;/appender&gt;</span><br></pre></td></tr></table></figure>
<p>在<root>标签或单个的<logger>标签里的Appender对象可以用<appender>标签定义。<appender>标签的基本形式如上面所示。它定义了appender的名字和类型。 另外比较重要的是<appender>标签内部的其他标签。不同的appender有不同的<param>标签。在这里，为了使用FileAppender,你需要一个文件名作为参数。另外还需要一个在<appender>标签内部定义一个Layout对象。Layout对象定义在它自己的<layout>标签内。<layout>标签的type属性定义了Layout的类型(在本例里是PatternLayout)，同时也确定了需要提供的参数值。Header和Footer标签提供了一个日志会话(logging session)开始和结束时输出的文字。有关每种appender的具体配置的例子，可以在log4net\doc\manual\example-config-appender.html中得到。 </layout></layout></appender></appender></appender></appender></logger></root></p>
<h3 id="log4net-Layout-PatternLayout中的转换模式-ConversionPattern"><a href="#log4net-Layout-PatternLayout中的转换模式-ConversionPattern" class="headerlink" title="log4net.Layout.PatternLayout中的转换模式(ConversionPattern)"></a>log4net.Layout.PatternLayout中的转换模式(ConversionPattern)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">%m(message):输出的日志消息，如ILog.Debug(…)输出的一条消息</span><br><span class="line">%n(new line):换行</span><br><span class="line">%d(datetime):输出当前语句运行的时刻</span><br><span class="line">%r(run time):输出程序从运行到执行到当前语句时消耗的毫秒数</span><br><span class="line">%t(thread id):当前语句所在的线程ID</span><br><span class="line">%p(priority): 日志的当前优先级别，即DEBUG、INFO、WARN…等</span><br><span class="line">%c(class):当前日志对象的名称，例如：</span><br><span class="line">       模式字符串为：%-10c -%m%n</span><br><span class="line">       代码为：</span><br><span class="line">ILog log=LogManager.GetLogger(“Exam.Log”);</span><br><span class="line">log.Debug(“Hello”);</span><br><span class="line">    则输出为下面的形式：</span><br><span class="line">Exam.Log       - Hello</span><br><span class="line">%L：输出语句所在的行号</span><br><span class="line">%F：输出语句所在的文件名</span><br><span class="line">%-数字：表示该项的最小长度，如果不够，则用空格填充</span><br><span class="line">例如，转换模式为%r [%t]%-5p %c - %m%n 的 PatternLayout 将生成类似于以下内容的输出：</span><br><span class="line">176 [main] INFO  org.foo.Bar - Located nearest gas station.</span><br></pre></td></tr></table></figure>
<h3 id="-3"><a href="#-3" class="headerlink" title=""></a><filter></filter></h3><p>最后，让我们看看在Appender元素里的<filter>标签。它定义了应用到Appender对象的过滤器。本例中，我们使用了LevelRangeFilter过滤器,它可以只记录LevelMin和LevelMax参数指定的日志级别之间的日志事件。可以在一个Appender上定义多个过滤器（Filter）,这些过滤器将会按照它们定义的顺序对日志事件进行过滤。其他过滤器的有关信息可以在log4net的SDK文档中找到。</filter></p>
<h2 id="使用配置文件"><a href="#使用配置文件" class="headerlink" title="使用配置文件"></a>使用配置文件</h2><h3 id="关联配置文件"><a href="#关联配置文件" class="headerlink" title="关联配置文件"></a>关联配置文件</h3><p>当我们创建了上面的配置文件后，我们接下来需要把它和我们的应用联系起来。缺省的，每个独立的可执行程序集都会定义它自己的配置。log4net框架使用 log4net.Config.DOMConfiguratorAttribute在程序集的级别上定义配置文件。<br>例如：可以在项目的AssemblyInfo.cs文件里添加以下的语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[assembly:log4net.Config.DOMConfigurator(ConfigFile=&quot;filename&quot;,</span><br><span class="line">  ConfigFileExtension=&quot;ext&quot;,Watch=true/false)]</span><br></pre></td></tr></table></figure></p>
<ul>
<li>ConfigFile:指出了我们的配置文件的路径及文件名，包括扩展名。</li>
<li>ConfigFileExtension:如果我们对被编译程序的程序集使用了不同的文件扩展名，那么我们需要定义这个属性，缺省的，程序集的配置文件扩展名为”config”。</li>
<li>Watch (Boolean属性): log4net框架用这个属性来确定是否需要在运行时监视文件的改变。如果这个属性为true,那么FileSystemWatcher将会被用来监视文件的改变，重命名，删除等事件。<br>其中：ConfigFile和ConfigFileExtension属性不能同时使用，ConfigFile指出了配置文件的名字，例如，ConfigFile=”Config.txt”<br>ConfigFileExtension则是指明了和可执行程序集同名的配置文件的扩展名，例如，应用程序的名称是”test.exe”,ConfigFileExtension=”txt”,则配置文件就应该是”test.exe.txt”；<br>也可以不带参数应用DOMConfiguratio():<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[assembly: log4net.Config.DOMConfigurator()]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>也可以在程序代码中用DOMConfigurator类打开配置文件。类的构造函数需要一个FileInfo对象作参数，以指出要打开的配置文件名。 这个方法和前面在程序集里设置属性打开一个配置文件的效果是一样的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log4net.Config.DOMConfigurator.Configure(</span><br><span class="line">  new FileInfo(&quot;TestLogger.Exe.Config&quot;));</span><br></pre></td></tr></table></figure></p>
<p>DOMConfigurator 类还有一个方法ConfigureAndWatch(..), 用来配置框架并检测文件的变化。<br>以上的步骤总结了和配置相关的各个方面，下面我们将分两步来使用logger对象。</p>
<h3 id="创建或获取日志对象"><a href="#创建或获取日志对象" class="headerlink" title="创建或获取日志对象"></a>创建或获取日志对象</h3><p>日志对象会使用在配置文件里定义的属性。如果某个日志对象没有事先在配置文件里定义，那么框架会根据继承结构获取祖先节点的属性，最终的，会从根日志获取属性。如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Log4net.ILog log = Log4net.LogManager.GetLogger(&quot;MyLogger&quot;);</span><br></pre></td></tr></table></figure></p>
<h3 id="输出日志信息"><a href="#输出日志信息" class="headerlink" title="输出日志信息"></a>输出日志信息</h3><p>可以使用ILog的几种方法输出日志信息。你也可以在调用某方法前先检查IsXXXEnabled布尔变量，再决定是否调用输出日志信息的函数，这样可以提高程序的性能。因为框架在调用如ILog.Debug(…)这样的函数时，也会先判断是否满足Level日志级别条件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (log.IsDebugEnabled) log.Debug(&quot;message&quot;);</span><br><span class="line">if (log.IsInfoEnabled) log.Info(&quot;message);</span><br></pre></td></tr></table></figure></p>
<h3 id="在程序中配置log4net"><a href="#在程序中配置log4net" class="headerlink" title="在程序中配置log4net"></a>在程序中配置log4net</h3><p>除了前面讲的用一个配置文件来配置log4net以外，还可以在程序中用代码来配置log4net框架。如下面的例子:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">// 和PatternLayout一起使用FileAppender</span><br><span class="line"></span><br><span class="line">log4net.Config.BasicConfigurator.Configure(</span><br><span class="line"></span><br><span class="line">  new log4net.Appender.FileAppender(</span><br><span class="line"></span><br><span class="line">     new log4net.Layout.PatternLayout(&quot;%d</span><br><span class="line"></span><br><span class="line">       [%t]%-5p %c [%x] - %m%n&quot;),&quot;testfile.log&quot;));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// using a FileAppender with an XMLLayout</span><br><span class="line"></span><br><span class="line">log4net.Config.BasicConfigurator.Configure(</span><br><span class="line"></span><br><span class="line">  new log4net.Appender.FileAppender(</span><br><span class="line"></span><br><span class="line">    new log4net.Layout.XMLLayout(),&quot;testfile.xml&quot;));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// using a ConsoleAppender with a PatternLayout</span><br><span class="line"></span><br><span class="line">log4net.Config.BasicConfigurator.Configure(</span><br><span class="line"></span><br><span class="line">  new log4net.Appender.ConsoleAppender(</span><br><span class="line"></span><br><span class="line">    new log4net.Layout.PatternLayout(&quot;%d</span><br><span class="line"></span><br><span class="line">      [%t] %-5p %c - %m%n&quot;)));</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">// using a ConsoleAppender with a SimpleLayout</span><br><span class="line"></span><br><span class="line">log4net.Config.BasicConfigurator.Configure(</span><br><span class="line"></span><br><span class="line">  new log4net.Appender.ConsoleAppender(new</span><br><span class="line"></span><br><span class="line">    log4net.Layout.SimpleLayout()));</span><br></pre></td></tr></table></figure></p>
<p>尽管这里用代码配置log4net也很方便，但是你却不能分别配置每个日志对象。所有的这些配置都是被应用到根日志上的。</p>
<p>log4net.Config.BasicConfigurator 类使用静态方法Configure 设置一个Appender 对象。而Appender的构造函数又会相应的要求Layout对象。你也可以不带参数直接调用BasicConfigurator.Configure()，它会使用一个缺省的PatternLayout对象，在一个ConsoleAppender中输出信息。如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4net.Config.BasicConfigurator.Configure();</span><br></pre></td></tr></table></figure></p>
<p>在输出时会显示如下格式的信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0 [1688] DEBUG log1 A B C - Test</span><br><span class="line">20 [1688] INFO log1 A B C - Test</span><br></pre></td></tr></table></figure></p>
<p>当log4net框架被配置好以后，就可以如前所述使用日志功能了。</p>
<h1 id="解决log4net独占日志文件的问题以及-log4net的各种输出配置-Appender"><a href="#解决log4net独占日志文件的问题以及-log4net的各种输出配置-Appender" class="headerlink" title="解决log4net独占日志文件的问题以及 log4net的各种输出配置(Appender)"></a>解决log4net独占日志文件的问题以及 log4net的各种输出配置(Appender)</h1><p>由于log4net默认情况下会独占日志文件，该文件不能被File.Open。<br>可以通过增加配置：<lockingmodel type="log4net.Appender.FileAppender+MinimalLock">来使用最小锁定模型（minimal locking model），以允许多个进程可以写入同一个文件。</lockingmodel></p>
<p>各种appender说明：<br>在log4net的配置中，appender是最重要的部分，一般来说，每一种appender都表示一种日志的输出介质，如日志文件、EvengLog、数据库、控制台、邮件、ASP.NET页面等。</p>
<p>本文对各种内置的appender的配置提供了示例，但却远称不上详尽。要想了解每一种appender的参数和选项的说明，请参看该appender的SDK文档。 </p>
<p>以下示例都是.NET 2.0下进行的, log4net的版本为1.2.10。</p>
<p>AdoNetAppender<br>详情参考 log4net.Appender. AdoNetAppender SDK文档。</p>
<p>AdoNetAppender的相关配置内容取决于目标数据库的provider。下面仅提供SQL Server 2000的例子。</p>
<p>首先建立数据表：</p>
<p>CREATE TABLE [dbo].[Log]<br> (<br>    [Id] [int] IDENTITY (1, 1) NOT NULL,<br>    [Date] [datetime] NOT NULL,<br>    [Thread] [varchar] (255) NOT NULL,<br>    [Level] [varchar] (50) NOT NULL,<br>    [Logger] [varchar] (255) NOT NULL,<br>    [Message] [varchar] (4000) NOT NULL,<br>    [Exception] [varchar] (2000) NULL<br>)</p>
<p>然后添加配置：</p>
<appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender"><br>    <buffersize value="2"><br>    <connectiontype value="System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=Neutral, PublicKeyToken=b77a5c561934e089"><br>    <connectionstring value="server=(local);database=TestBase;integrated security=false;persist security info=True;UID=sa;PWD="><br>    <commandtext value="INSERT INTO Log ([Date],[Thread],[Level],[Logger],[Message],[Exception]) VALUES (@log_date, @thread, @log_level, @logger, @message, @exception)"><br>    <parameter><br>        <parametername value="@log_date"><br>        <dbtype value="DateTime"><br>        <layout type="log4net.Layout.RawTimeStampLayout"><br>    </layout></dbtype></parametername></parameter><br>    <parameter><br>        <parametername value="@thread"><br>        <dbtype value="String"><br>        <size value="255"><br>        <layout type="log4net.Layout.PatternLayout"><br>            <conversionpattern value="%thread"><br>        </conversionpattern></layout><br>    </size></dbtype></parametername></parameter><br>    <parameter><br>        <parametername value="@log_level"><br>        <dbtype value="String"><br>        <size value="50"><br>        <layout type="log4net.Layout.PatternLayout"><br>            <conversionpattern value="%level"><br>        </conversionpattern></layout><br>    </size></dbtype></parametername></parameter><br>    <parameter><br>        <parametername value="@logger"><br>        <dbtype value="String"><br>        <size value="255"><br>        <layout type="log4net.Layout.PatternLayout"><br>            <conversionpattern value="%logger"><br>        </conversionpattern></layout><br>    </size></dbtype></parametername></parameter><br>    <parameter><br>        <parametername value="@message"><br>        <dbtype value="String"><br>        <size value="4000"><br>        <layout type="log4net.Layout.PatternLayout"><br>            <conversionpattern value="%message"><br>        </conversionpattern></layout><br>    </size></dbtype></parametername></parameter><br>    <parameter><br>        <parametername value="@exception"><br>        <dbtype value="String"><br>        <size value="2000"><br>        <layout type="log4net.Layout.ExceptionLayout"><br>    </layout></size></dbtype></parametername></parameter><br></commandtext></connectionstring></connectiontype></buffersize></appender>

<p>bufferSize表示批处理的日志事件，可以避免每次日志事件都访问数据库；ConnectionType指定了要使用的IDbConnection的完全限定类型名称；connectionString表示连接字符串；CommandText是SQL语句或存储过程；最后一组parameter节点描述了SQL语句或存储过程需要的参数。 </p>
<p>AspNetTraceAppender </p>
<p>详情参考 log4net.Appender.AspNetTraceAppender SDK 文档。  </p>
<appender name="AspNetTraceAppender" type="log4net.Appender.AspNetTraceAppender"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <conversionpattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"><br>    </conversionpattern></layout><br></appender>

<p>这段配置可将日志信息输出到页面的Trace上下文环境。如果日志的级别低于WARN，会以System.Web.TraceContext.Write方法输出；如果级别为WARN或WARN以上则会以System.Web.TraceContext.Warn方法输出，下图中的日志信息的不同颜色可以说明这一点。效果图如下：</p>
<p>这在进行页面调试的时候可是很方便的。<br>BufferingForwardingAppender</p>
<p>详情参考 log4net.Appender.BufferingForwardingAppender SDK 文档。 </p>
<appender name="BufferingForwardingAppender" type="log4net.Appender.BufferingForwardingAppender"><br>    <buffersize value="5"><br>    <lossy value="true"><br>    <evaluator type="log4net.Core.LevelEvaluator"><br>        <threshold value="WARN"><br>    </threshold></evaluator><br>    <appender-ref ref="LogFileAppender"><br>    <appender-ref ref="AspNetTraceAppender"><br></appender-ref></appender-ref></lossy></buffersize></appender>

<p>BufferingForwardingAppender的主要作用是将输出到指定类型（这里是LogFileAppender）的Appender的日志信息进行缓存。bufferSize属性指定了缓存的数量，如果value为5，那么将在信息量达到6条的时候，把这些日志批量输出。appender-ref属性指定了缓存的Appender类型，同root节点一样，这里可以指定多个。 </p>
<p>ColoredConsoleAppender<br>详情参考log4net.Appender.ColoredConsoleAppender SDK 文档。</p>
<p>ColoredConsoleAppender将日志信息输出到控制台。默认情况下，日志信息被发送到控制台标准输出流。下面这个示例演示了如何高亮显示Error信息。 </p>
<appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender"><br>    <mapping><br>        <level value="ERROR"><br>        <forecolor value="White"><br>        <backcolor value="Red, HighIntensity"><br>    </backcolor></forecolor></level></mapping><br>    <layout type="log4net.Layout.PatternLayout"><br>        <conversionpattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"><br>    </conversionpattern></layout><br></appender>

<p>效果如下：</p>
<p>还可以为不同的级别指定不同的颜色： </p>
<appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender"><br>    <mapping><br>        <level value="ERROR"><br>        <forecolor value="White"><br>        <backcolor value="Red, HighIntensity"><br>    </backcolor></forecolor></level></mapping><br>    <mapping><br>        <level value="DEBUG"><br>        <backcolor value="Green"><br>    </backcolor></level></mapping><br>    <layout type="log4net.Layout.PatternLayout"><br>        <conversionpattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"><br>    </conversionpattern></layout><br></appender>

<p>效果如下：</p>
<p>ConsoleAppender<br>详情参考 log4net.Appender.ConsoleAppender SDK 文档。</p>
<p>ConsoleAppender将日志信息输出到控制台标准输出流。</p>
<appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <param name="ConversionPattern" value="%d [%t] %-5p %c [%x] - %m%n"><br>    </layout><br></appender>

<p>EventLogAppender<br>详情参考 log4net.Appender.EventLogAppender SDK 文档。 </p>
<p>EventLogAppender将日志写入本地机器的应用程序事件日志中。默认情况下，该日志的源（Source）是AppDomain.FriendlyName，也可以手动指定其它名称。 </p>
<appender name="EventLogAppender" type="log4net.Appender.EventLogAppender"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <param name="ConversionPattern" value="%d [%t] %-5p %c [%x] - %m%n"><br>    </layout><br></appender><br>FileAppender<br><br>详情参考 log4net.Appender.File Appender SDK 文档。<br><br>FileAppender将日志信息输出到指定的日志文件。<br><br><!--[if !vml]--><br><br><appender name="LogFileAppender" type="log4net.Appender.FileAppender"><br>    <param name="File" value="WebUtilClient.log"><br>    <param name="AppendToFile" value="true"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <param name="ConversionPattern" value="%d [%t] %-5p %c [%x] - %m%n"><br>    </layout><br></appender>

<p>File指定了文件名称，可以使用相对路径，此时日志文件的位置取决于项目的类型（如控制台、Windows Forms、ASP.NET等）；也可以使用绝对路径；甚至可以使用环境变量，如<file value="${TMP}/log-file.txt">。<br>AppendToFile指定是追加到还是覆盖掉已有的日志文件。<br>还可以添加如下属性<lockingmodel type="log4net.Appender.FileAppender+MinimalLock">来使用最小锁定模型（minimal locking model），以允许多个进程可以写入同一个文件。<br>ForwardingAppender </lockingmodel></file></p>
<p>详情参考 log4net.Appender.ForwardingAppender SDK 文档。 </p>
<p>ForwardingAppender可以用来为一个Appender指定一组约束。看下面这个示例：</p>
<appender name="ForwardingAppender" type="log4net.Appender.ForwardingAppender"><br>    <threshold value="WARN"><br>    <appender-ref ref="ConsoleAppender"><br></appender-ref></threshold></appender>

<p>在这个示例中，为ConsoleAppender添加了约束，Threshold为WARN。这意味着对于一条日志信息，如果直接使用ConsoleAppender，那么不论它是什么级别，总会进行输出，而如果使用这个ForwardingAppender，则只有那些WARN或WARN以上的日志才会发送到ConsoleAppender。<br>MemoryAppender</p>
<p>详情参考 log4net.Appender.MemoryAppender SDK 文档。 </p>
<p>似乎不应该使用配置文件来配置MemoryAppender，但如果你非要这么做，看看这个示例（未验证）：</p>
<appender name="MemoryAppender" type="log4net.Appender.MemoryAppender"><br>    <onlyfixpartialeventdata value="true"><br></onlyfixpartialeventdata></appender>

<p>NetSendAppender<br>详情参考 log4net.Appender.NetSendAppender SDK 文档。</p>
<p>NetSendAppender向特定用户的屏幕发送消息（未验证）。</p>
<appender name="NetSendAppender" type="log4net.Appender.NetSendAppender"><br>    <threshold value="ERROR"><br>    <server value="Anders"><br>    <recipient value="xym"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <conversionpattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"><br>    </conversionpattern></layout><br></recipient></server></threshold></appender>

<p>OutputDebugStringAppender </p>
<p>详情参考 log4net.Appender.OutputDebugStringAppender SDK 文档。<br>下面这个例子描述了如何配置该Appender以向OutputDebugString API写入日志（未验证）。 </p>
<appender name="OutputDebugStringAppender" type="log4net.Appender.OutputDebugStringAppender"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <conversionpattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"><br>    </conversionpattern></layout><br></appender>

<p>RemotingAppender<br>详情参考 log4net.Appender.RemotingAppender SDK 文档。</p>
<p>RemotingAppender向特定的Sink发送日志信息（未验证）：</p>
<!--[if !vml]-->
<appender name="RemotingAppender" type="log4net.Appender.RemotingAppender"><br>    <sink value="tcp://localhost:8085/LoggingSink"><br>    <lossy value="false"><br>    <buffersize value="95"><br>    <onlyfixpartialeventdata value="true"><br></onlyfixpartialeventdata></buffersize></lossy></sink></appender><br>RollingFileAppender<br><br>详情参考 log4net.Appender.RollingFileAppender SDK 文档。<br><br>RollingFileAppender以FileAppender为基础，与后者有着相同的配置选项。<br><br>下面这个例子演示了如何配置RollingFileAppender以写入log.txt文件。写入的文件名总是为log.txt（StaticLogFileName参数指定为true）；根据文件大小（RollingStyle）来生成新的文件；最多保存有10个文件（MaxSizeRollBackups属性，而且一旦写满10个文件，就不再写入日志了），每个文件最大为10KB。这些文件名称为log.txt.1, log.txt.2…等。<br><br><appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender"><br>    <param name="File" value="log/Log.txt"><br>    <param name="AppendToFile" value="true"><br>    <param name="MaxSizeRollBackups" value="10"><br>    <param name="MaximumFileSize" value="5MB"><br>    <param name="RollingStyle" value="Size"><br>    <param name="StaticLogFileName" value="true"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <param name="ConversionPattern" value="%d [%t] %-5p %c [%x] - %m%n"><br>    </layout><br></appender>

<p>SmtpAppender </p>
<p>详情参考 log4net.Appender.SmtpAppender SDK 文档。<br>SmtpAppender通过Smtp邮件服务器发送日志信息：</p>
<pre><code>&lt;appender name=&quot;SmtpAppender&quot; type=&quot;log4net.Appender.SmtpAppender&quot;&gt;
    &lt;authentication value=&quot;Basic&quot; /&gt;
    &lt;to value=&quot;anderscui@tom.com&quot; /&gt;
    &lt;from value=&quot;anderscui@163.com&quot; /&gt;
    &lt;username value=&quot;anderscui&quot; /&gt;
    &lt;password value=&quot;password&quot; /&gt;
    &lt;subject value=&quot;test logging message&quot; /&gt;
    &lt;smtpHost value=&quot;smtp.163.com&quot; /&gt;
    &lt;bufferSize value=&quot;512&quot; /&gt;
    &lt;lossy value=&quot;true&quot; /&gt;
    &lt;evaluator type=&quot;log4net.Core.LevelEvaluator&quot;&gt;
        &lt;threshold value=&quot;WARN&quot;/&gt;
    &lt;/evaluator&gt;
    &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;
        &lt;conversionPattern value=&quot;%newline%date [%thread] %-5level %logger [%property{NDC}] - %message%newline%newline%newline&quot; /&gt;
    &lt;/layout&gt;
&lt;/appender&gt;
</code></pre><p>将其中的to、from、username、password、subject、smtpHost配置正确才可能发送成功。bufferSize可将多条信息打包在一个邮件中。evaluator可以对日志进行过滤。<br>SmtpPickupDirAppender</p>
<p>详情参考 log4net.Appender.SmtpPickupDirAppender SDK 文档。</p>
<p>配置与SmtpAppender类似，但要把SmtpHost换为PickupDir（未验证）。</p>
<appender name="SmtpPickupDirAppender" type="log4net.Appender.SmtpPickupDirAppender"><br>    <to value="to@domain.com"><br>    <from value="from@domain.com"><br>    <subject value="test logging message"><br>    <pickupdir value="C:/SmtpPickup"><br>    <buffersize value="512"><br>    <lossy value="true"><br>    <evaluator type="log4net.Core.LevelEvaluator"><br>        <threshold value="WARN"><br>    </threshold></evaluator><br>    <layout type="log4net.Layout.PatternLayout"><br>        <conversionpattern value="%newline%date [%thread] %-5level %logger [%property{NDC}] - %message%newline%newline%newline"><br>    </conversionpattern></layout><br></lossy></buffersize></pickupdir></subject></from></to></appender><br>TraceAppender<br><br>详情参考 log4net.Appender.TraceAppender SDK 文档。<br><br>TraceAppender将日志信息写入System.Diagnostics.Trace系统（出现在输出窗口）。<br><br><appender name="TraceAppender" type="log4net.Appender.TraceAppender"><br>    <layout type="log4net.Layout.PatternLayout"><br>        <conversionpattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"><br>    </conversionpattern></layout><br></appender>

<p>UdpAppender<br>详情参考 log4net.Appender.UdpAppender SDK 文档。</p>
<p>下例演示了如何配置UdpAppender(未验证)：</p>
<appender name="UdpAppender" type="log4net.Appender.UdpAppender"><br>    <localport value="8080"><br>    <remoteaddress value="224.0.0.1"><br>    <remoteport value="8080"><br>    <layout type="log4net.Layout.PatternLayout, log4net"><br>        <conversionpattern value="%-5level %logger [%property{NDC}] - %message%newline"><br>    </conversionpattern></layout><br></remoteport></remoteaddress></localport></appender>

<p>上面有若干个Appender标注为”未验证”的，是指这些Appender极少用到，或者在我的机器上没能实现 :(</p>
<p>希望这些内容能对您有所帮助。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/06/Log4net学习/" data-id="cjjwkdfn7000jhsuq1yfzjdvb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Hexo的使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/05/Hexo的使用/" class="article-date">
  <time datetime="2018-01-05T06:16:22.000Z" itemprop="datePublished">2018-01-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/05/Hexo的使用/">Hexo的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="使用Hexo生成博文中播入图片"><a href="#使用Hexo生成博文中播入图片" class="headerlink" title="使用Hexo生成博文中播入图片"></a>使用Hexo生成博文中播入图片</h1><ol>
<li>把主页配置文件_config.yml 里的post_asset_folder:这个选项设置为true</li>
<li><p>在你的hexo目录下执行如下命令，下载一个可以上传本地图片的插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;newblog&quot;</span><br></pre></td></tr></table></figure>
<p> 生成newblog.md的同时，会生成一个同名的文件在Source目录下，将你要引用的图片放入这个目录下，在文章中引用图片时，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![你想输入的文字](xxxx/图片名.jpg)</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/05/Hexo的使用/" data-id="cjjwkdfmo000bhsuqff44up7r" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-SourceTree使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/05/SourceTree使用/" class="article-date">
  <time datetime="2018-01-05T04:55:38.000Z" itemprop="datePublished">2018-01-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/05/SourceTree使用/">SourceTree使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SourceTree的安装"><a href="#SourceTree的安装" class="headerlink" title="SourceTree的安装"></a>SourceTree的安装</h1><p>   安装没什么好说，但安装之后需要登陆之后才能使用，这个登陆也不知道怎么搞的，总是失败，在网上查找了一些解决方法，跳过这个初始化步骤。当然如果你人品好，登陆正常，可以跳过此步。</p>
<h3 id="跳过初始化步骤"><a href="#跳过初始化步骤" class="headerlink" title="跳过初始化步骤"></a>跳过初始化步骤</h3><p>在目录 C:\Users{youruser}\AppData\Local\Atlassian\SourceTree 下创建文件accounts.json<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;$id&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;$type&quot;: &quot;SourceTree.Api.Host.Identity.Model.IdentityAccount, SourceTree.Api.Host.Identity&quot;,</span><br><span class="line">    &quot;Authenticate&quot;: true,</span><br><span class="line">    &quot;HostInstance&quot;: &#123;</span><br><span class="line">      &quot;$id&quot;: &quot;2&quot;,</span><br><span class="line">      &quot;$type&quot;: &quot;SourceTree.Host.Atlassianaccount.AtlassianAccountInstance, SourceTree.Host.AtlassianAccount&quot;,</span><br><span class="line">      &quot;Host&quot;: &#123;</span><br><span class="line">        &quot;$id&quot;: &quot;3&quot;,</span><br><span class="line">        &quot;$type&quot;: &quot;SourceTree.Host.Atlassianaccount.AtlassianAccountHost, SourceTree.Host.AtlassianAccount&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;atlassian account&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;BaseUrl&quot;: &quot;https://id.atlassian.com/&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;Credentials&quot;: &#123;</span><br><span class="line">      &quot;$id&quot;: &quot;4&quot;,</span><br><span class="line">      &quot;$type&quot;: &quot;SourceTree.Model.BasicAuthCredentials, SourceTree.Api.Account&quot;,</span><br><span class="line">      &quot;Username&quot;: &quot;&quot;,</span><br><span class="line">      &quot;Email&quot;: null</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;IsDefault&quot;: false</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/05/SourceTree使用/" data-id="cjjwkdfng000phsuqomyxtn33" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-OSharp读书笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/04/OSharp读书笔记/" class="article-date">
  <time datetime="2018-01-04T07:50:42.000Z" itemprop="datePublished">2018-01-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/04/OSharp读书笔记/">OSharp读书笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="EntityFramework与其它ORM相比有什么优点"><a href="#EntityFramework与其它ORM相比有什么优点" class="headerlink" title="EntityFramework与其它ORM相比有什么优点"></a>EntityFramework与其它ORM相比有什么优点</h1><ul>
<li>EntityFramework 是微软大力发展的一个开源项目，EF 6 在 codeplex.com 开源，EF 7 在 github.com 随 ASP.NET 5 开源。</li>
<li>EntityFramework 能轻松支持各大主流数据库，只要引入相应数据库的 DataProvider 即可，能无差异的操作各大主流数据库。</li>
<li>EntityFramework 支持 linq to entities 语句查询，强类型支持，高效实现查询需求。</li>
<li>EntityFramework 全面封装了数据库细节，使用了大量的“约定胜于配置”的思想，使开发者不必直接对关系存储架构编程，减少代码量，减轻维护工作，并使项目可维护性更高</li>
</ul>
<h1 id="为什么要封装EntityFramework"><a href="#为什么要封装EntityFramework" class="headerlink" title="为什么要封装EntityFramework"></a>为什么要封装EntityFramework</h1><ul>
<li>不是所有的开发人员都对 EntityFramework 足够熟悉，封装之后能将 EntityFramework 的细节及较敏感的 API 进行包装与隐藏，使 EntityFramework 的使用更加透明易用。</li>
<li>统一的封装，有利于对业务层提供统一的 API，对业务层的代码规范非常有利。</li>
<li>封装有利于业务实体与 EntityFramework 的解耦。如果不封装，所有业务实体模型（Model）都要在上下文类中设置一个 DbSet<tentity> 类型的实体集，将与上下文强耦合，当需求发生变化时，都要对原有代码进行修改，很不利于维护。而封装之后，所有的实体模型都是动态加载到上下文类中的，业务实体与 EntityFramework 能够完全解耦，大大增强系统的可维护性。 </tentity></li>
</ul>
<h1 id="IEnumerable-与-IQueryable-的区别"><a href="#IEnumerable-与-IQueryable-的区别" class="headerlink" title="IEnumerable 与 IQueryable 的区别"></a>IEnumerable<t> 与 IQueryable<t> 的区别</t></t></h1><p>　　在设计数据访问层的查询API的时候，IEnumerable<t> 和 IQueryable<t> 都可以作为集合类查询结果的返回类型，那么，这两者有什么区别呢？为什么误用的时候会造成致命的性能问题呢？<br>　　IEnumerable<t> 接口的声明为：　</t></t></t></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/// &lt;summary&gt;</span><br><span class="line">/// 公开枚举数，该枚举数支持在指定类型的集合上进行简单迭代。</span><br><span class="line">/// &lt;/summary&gt;</span><br><span class="line">public interface IEnumerable&lt;out T&gt; : IEnumerable</span><br></pre></td></tr></table></figure>
<p>IQueryable&lt;&lt;T&gt; 接口的声明为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/// &lt;summary&gt;</span><br><span class="line">/// 提供对数据类型已知的特定数据源的查询进行计算的功能。</span><br><span class="line">/// &lt;/summary&gt;</span><br><span class="line">public interface IQueryable&lt;out T&gt; : IEnumerable&lt;T&gt;, IQueryable, IEnumerable</span><br></pre></td></tr></table></figure>
<p>在进行查询的时候，IEnumerable<t> 接口接受一个 Func&lt;T, bool&gt; 类型的委托参数： public static IEnumerable<tsource> Where<tsource>(this IEnumerable<tsource> source, Func&lt;TSource, bool&gt; predicate); ，而 IQueryable<t> 接口接受一个 Expression&lt;Func&lt;T, bool&gt;&gt; 类型的表达式参数： public static IQueryable<tsource> Where<tsource>(this IQueryable<tsource> source, Expression&lt;Func&lt;TSource, bool&gt;&gt; predicate); 。<br>正因为 IEnumerable<t> 接受的参数 predicate 数据类型是委托类型，所以这个参数在被调用的时候，就会立即执行查询逻辑，然后将查询的结果保存在内存中，后续的查询逻辑是完全在内存中执行的。而 IQueryable<t> 接受的参数 predicate 数据类型是表达式类型，这个参数会一直往下传递，直到被 IQueryable 中的 IQueryableProvider 类型的 Provider 属性解析成真正的查询语句（如 sql 语句），才传到数据源中进行查询动作。<br>所以，如果查询返回的数据集合很大的时候，使用 IEnumerable<t> 作为返回类型，会将这个数据集合立即加载到内存中，比如在设计 IRepository<t> 的 API 时，设计  IEnumerable<t> GetAll(); ， IEnumerable<t> GetByPredicate(Func&lt;T, bool&gt; predicate); 这种 API ，是非常可怕的，如果一个表中有几十上百万的数据，也同样会把所有数据加载到内存中，可能直接就导致服务器宕机了。即使数据量不大，当并发量上来的时候，也同样会造成极大的性能问题。</t></t></t></t></t></t></tsource></tsource></tsource></t></tsource></tsource></tsource></t></p>
<h1 id="过早地内存化数据"><a href="#过早地内存化数据" class="headerlink" title="过早地内存化数据"></a>过早地内存化数据</h1><p>　　IEnumerable<t> 类型与 IQueryable<t> 类型是支持延迟的，没有真正使用数据之前，不管怎么调用，都不会执行查询，数据还是在数据库内，只有真正使用数据的时候，才会执行查询，把数据本地化到内存中。这样一来，什么时候执行本地化操作（ToArray()，ToList()等操作）就显得非常重要了，如果过早的执行本地化操作，那么就容易造成加载到内存的数据集合过于庞大，记录条数过多，造成性能问题。因此，在进行数据查询的时候，原则上应该按需获取数据，取出的数据集合就尽量的小，字段应尽量少，到数据真正使用的时候，才执行数据内存本地化操作。对于筛选部分字段的需求，linq to entities 的 select 查询匿名结果的查询方式，提供了有力的支持。</t></t></p>
<h1 id="导航属性的延迟加载与循环"><a href="#导航属性的延迟加载与循环" class="headerlink" title="导航属性的延迟加载与循环"></a>导航属性的延迟加载与循环</h1><p>　　EntityFramework 实体模型的导航属性（即与当前表有外键关系的关联表）通常标记为 virtual，标记为 virtual 之后，相应属性的数据是具有延迟加载的特性的，只有真正用到相应属性的数据时，才会根据外键关系执行相应的查询动作，加载相应的数据。延迟加载的特性，能给系统性能带来优化，因为加载主干实体时只加载主干实体的信息，不会把关联实体的信息都加载进来，关联实体的数据只有用到的时候都会去加载。但也正是因为延迟加载，导航属性的数据是用到一次就执行一次查询动作，加载一次数据，一次还如，如果对于相同实体，需要多次用到同一个导航属性，就会产生多次重复的查询动作来加载导航属性的数据，给系统带来性能问题。例如如下的操作：</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/04/OSharp读书笔记/" data-id="cjjwkdfn9000khsuqzpvsg7e9" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-FundManage设计" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/01/04/FundManage设计/" class="article-date">
  <time datetime="2018-01-04T02:49:44.000Z" itemprop="datePublished">2018-01-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/01/04/FundManage设计/">设计概要</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="设计概要"><a href="#设计概要" class="headerlink" title="设计概要"></a>设计概要</h1><h2 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h2><h3 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h3><p>包含但不限于：<br>编码、中文名称、最新净值、净值日期<br>设置状态：分级：一般、关注、持有</p>
<h3 id="历史净值"><a href="#历史净值" class="headerlink" title="历史净值"></a>历史净值</h3><h3 id="交易记录"><a href="#交易记录" class="headerlink" title="交易记录"></a>交易记录</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/01/04/FundManage设计/" data-id="cjjwkdfml0008hsuqjd9edkfz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/学习笔记/">学习笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/学习笔记/" style="font-size: 10px;">学习笔记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/07/22/打造自己的linqProvider/">打造自己的linqProvider</a>
          </li>
        
          <li>
            <a href="/2018/07/21/CSS入门及提高/">CSS入门及提高</a>
          </li>
        
          <li>
            <a href="/2018/07/18/从零做一个前端开源项目学习笔记/">从零做一个前端开源项目学习笔记</a>
          </li>
        
          <li>
            <a href="/2018/07/09/SQL Server编程入门经典/">SQL Server编程入门经典</a>
          </li>
        
          <li>
            <a href="/2018/07/07/EasyUI TreeGrid使用总结/">EasyUI TreeGrid使用总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>